---
apiVersion: batch/v1
kind: CronJob
metadata:
  name: retirement-job
  labels:
    app.kubernetes.io/component: cronjob
spec:
  schedule: '{{ RETIREMENT_K8S_CRONJOB_SCHEDULE }}'
  jobTemplate:
    spec:
      template:
        spec:
          containers:
            - name: retirement
              image: {{ RETIREMENT_DOCKER_IMAGE }}
              command:
                - bash
                - run_retirement_pipeline.sh
                - {{ RETIREMENT_COOL_OFF_DAYS }}
          restartPolicy: OnFailure
